<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>Articulillos</title>
<script src="/assets/tailwind.js"></script>
<link href="/assets/fonts.css" rel="stylesheet">
<style>
  body {
    font-family: 'Orbitron', sans-serif;
    background-color: #0f172a;
    color: white;
  }

  #contenedor-tarjetas img {
    background-color: white;
  }

.line-clamp-5 {
  display: -webkit-box;
  -webkit-line-clamp: 5;
  -webkit-box-orient: vertical;
  overflow: hidden;
}

</style>
</head>
<body class="min-h-screen p-6">








  <!-- Navbar -->
  <nav class="bg-gradient-to-r from-purple-800 via-indigo-800 to-blue-800 p-4 text-center text-sm md:text-base font-semibold uppercase tracking-wider">
    <a href="/../e.html" class="mx-3 hover:text-yellow-400">Inicio</a>
  </nav>

  <!-- Encabezado -->
  <section class="max-w-7xl mx-auto px-6 mb-10">
    <div class="relative flex items-center justify-between">
      <div class="absolute -left-4 md:-left-10 z-20">
  <video autoplay muted loop
         class="w-40 h-40 md:w-52 md:h-52 object-cover rounded-full border-4 border-yellow-400 shadow-2xl">
    <source src="/ruta/articulillos.mp4" type="video/mp4">
  </video>
      </div>
      <div class="w-full bg-purple-800 h-28 md:h-32 rounded-xl flex items-center pl-48 pr-6 z-10 shadow-lg">
        <h2 class="text-2xl md:text-4xl text-yellow-400 font-bold ml-auto">Articulillos</h2>
      </div>
    </div>
</section>







  
<section class="max-w-7xl mx-auto px-6 mt-6 mb-10">


  <h1 class="text-3xl text-yellow-400 font-bold mb-6">Asignar Departamento</h1>
<p></p>

  <div class="flex flex-col items-center justify-between gap-4 mb-6">

    <div>
<a href ="Articulillos_designacion.html">Rea signacion</a>&nbsp; |&nbsp; <a href ="Articulillos.html">Articulillos</a>&nbsp; |&nbsp;  <a href ="duplicados.html">Rea signacion</a>&nbsp; |&nbsp;   


    </div>


  <div class="mb-6">
    <label for="departamentoSelect" class="block mb-2">Selecciona nuevo departamento:</label>
    <select id="departamentoSelect" class="text-black px-3 py-2 rounded w-full max-w-md">
      <!-- Opciones generadas por JS -->
    </select>
  </div>

  <div class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4 mb-6" id="contenedor">
    <!-- Tarjetas generadas por JS -->
  </div>

  <button onclick="asignarSeleccionados()" class="bg-green-500 hover:bg-green-600 text-white font-bold py-2 px-4 rounded">
    Asignar Departamento a Seleccionados
  </button>

  <script>
    const departamentos = {
      0: "Pendientes de Desinar", 1: "Bigger", 2: "Serie", 3: "Anime", 4: "Bodybuilder arabes",
      5: "sumo", 7: "Bodybuilder", 8: "noticias", 9: "Model", 10: "Video juego", 11: "Teatro",
      12: "Strongman", 13: "Actor", 14: "Bodybulder Asiaticos", 15: "Cosas Pendientes", 16: "Gladiator",
      17: "Furia ciega / Actores", 18: "wf", 19: "Buscar actor", 20: "Banco de Imagenes", 22: "Bodybulder Africanos",
      23: "Tecnologia", 24: "Codigo", 25: "comic", 26: "Manga", 27: "wrestler", 50: "Sectas", 51: "Tiendas",
      52: "Mitologia Grecorromana", 53: "Personajes Historicos", 54: "Programas Tv", 55: "Otras mitologia",
      56: "Deportistas", 57: "Banco de imagenes", 58: "Comunidadedes", 59: "Gente Ejemplar",
      606: "Artistas Circensese", 607: "Nintendio Swqith", 608: "Regalos", 609: "Tareas", 610: "Luchador",
      611: "Manga que sigo", 612: "Modelos", 613: "wrestler", 615: "Personaje Comic", 616: "Baloncesto",
      1003: "Art", 1004: "wrestler Hiperpesados", 1005: "Comic que deseo", 1006: "Mamga a revisar que no Comprar",
      1007: "Libros qiue quiero", 1008: "Emuladores y Descargas", 1009: "Actors que me gustaria tener sus Pelis",
      1010: "Escritores", 1012: "Peliculas que deseo Tener", 1013: "Musicos", 1014: "Football",
      1017: "Rugby", 1018: "Inteligencia Artificial", 2001: "Descargar Comic", 2002: "Manga OSOS",
      5665: "Dibulgadores", 22022: "Ps4", 22023: "Ps5", 22024: "Nfl",  22025: "Cosas Historicas", 22026: "Otras Emulaciones",
    };

    const contenedor = document.getElementById("contenedor");
    const select = document.getElementById("departamentoSelect");

    // Cargar opciones en el select (excepto 0)
    for (const [val, nombre] of Object.entries(departamentos)) {
      if (val !== "0") {
        const opt = new Option(nombre, val);
        select.appendChild(opt);
      }
    }

    let articulillos = [];

    fetch("/api/articulillos")
      .then(res => res.json())
      .then(data => {
        articulillos = data.filter(a => a.departamento === 0);
        mostrarTarjetas();
      });

    function mostrarTarjetas() {
      contenedor.innerHTML = "";
      articulillos.forEach(a => {
        const card = document.createElement("div");
        card.className = "bg-gray-800 p-4 rounded shadow-md flex flex-col items-center";
        card.innerHTML = `
          <img src="${a.imagen || '/articulillos/ima/default.png'}" class="w-full h-40 object-cover rounded mb-2 shadow" alt="${a.nombre}">
          <h3 class="text-yellow-400 font-bold text-center">${a.nombre}</h3>
          <p class="text-xs text-gray-300 text-center mb-2 line-clamp-2">${a.descripcion}</p>
          <input type="checkbox" class="checkboxAsignar" value="${a.id}" />
        `;
        contenedor.appendChild(card);
      });
    }

    function asignarSeleccionados() {
      const seleccionados = Array.from(document.querySelectorAll(".checkboxAsignar:checked"))
        .map(c => c.value);

      const nuevoDepto = select.value;
      if (!nuevoDepto) {
        alert("Selecciona un departamento.");
        return;
      }
      if (seleccionados.length === 0) {
        alert("Selecciona al menos un artículo.");
        return;
      }

      Promise.all(seleccionados.map(id =>
        fetch(`/api/articulillos/${id}`, {
          method: "PUT",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify({ departamento: nuevoDepto })
        })
      ))
      .then(respuestas => Promise.all(respuestas.map(r => r.json())))
      .then(() => {
        alert("Departamento actualizado.");
        location.reload();
      })
      .catch(err => {
        console.error(err);
        alert("Error al actualizar artículos.");
      });
    }
  </script>
</body>
</html>
